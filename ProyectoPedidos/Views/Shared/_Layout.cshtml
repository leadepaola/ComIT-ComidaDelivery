<!DOCTYPE html>
<html>
<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title</title>

    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)

    <link href="~/Content/estilos.css" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

</head>
<body>
    <div id="rec"></div>

    <header id="headerLogo">
        <nav id="navLogo">
            <ul class="ulLogo">
                <a class="aLogo"><li class="liLogo">Inicio</li></a>
                <a class="aLogo"><li class="liLogo">Videos</li></a>
                <a class="aLogo"><li class="liLogo">Im&aacute;genes</li></a>
            </ul>

            <img id='logo' src='~/Content/Imagenes/pedidos2.png'>

            <ul class="ulLogo">
                <a class="aLogo"><li class="liLogo">Youtube</li></a>
                <a class="aLogo"><li class="liLogo">Nosotros</li></a>
                <a class="aLogo"><li class="liLogo">Contacto</li></a>
            </ul>
        </nav>
    </header>

    <script>
        $(document).ready(function () {



            $("#rec").css({ "height": $(window).height() + "px" });

            $("#logo").css({ "margin-top": "-5px", "width": "50px", "height": "50px" });

            $("#headerLogo").css({ "background-color": "#3C3C3C" });

            var flag = false;
            var scroll;
            var con = 1;
            if (con = 1) {
                $("#logo").css({ "margin-top": "170px", "width": "250px", "height": "250px" });
                $("#headerLogo").css({ "background-color": "transparent" });
                con++;
            }

            $("#navLogo").mouseover(function () {
                $("#logo").css({ "margin-top": "-70px", "width": "45px", "height": "45px" });


                $("#navLogo").css({ "margin-top": "-70px" });

                $("#headerLogo").css({ "margin-top": "-70px" });

                $("#rec").css({ "opacity": "0", "z-index": "-1" });

                $(".navbar-inverse").css({ "height": "20px" });
            });
        });
    </script>

    @{
        List<Comercio2> comercios = ViewBag.comercios;
        string s = "";
        List<Comercio2> comercios2 = ViewBag.comercios2;
        string y = "";
    }
  


    <script>
        // If you're adding a number of markers, you may want to drop them on the map
        // consecutively rather than all at once. This example shows how to use
        // window.setTimeout() to space your markers' animation.






        var neighborhoods = [


                 @{
                     int i = 0;
                     foreach (Comercio2 c in comercios)
                     {
                         i++;
                         if (i == comercios.Count)
                         {
                             s += "{ lat:" + c.lat.ToString().Replace(",", ".") + ", lng:" + c.lng.ToString().Replace(",", ".") + "}";
                         }
                         else
                         {
                             s += "{ lat:" + c.lat.ToString().Replace(",", ".") + ", lng:" + c.lng.ToString().Replace(",", ".") + "},";
                         }
                     }
            }
            @(s)


        @*
            @{
                foreach (Comercio2 c in comercios)
                {
                    s += "{ lat:" + c.lat.ToString().Replace(",",".") + ", lng:" + c.lng.ToString().Replace(",", ".") + "}";
                }

            }
            @(s),

            @{
                foreach(Comercio2 f in comercios2)
                {
                y += "{ lat:" + f.lat.ToString().Replace(",", ".") + ", lng:" + f.lng.ToString().Replace(",", ".") + "}";
                }
            }
            @(y)*@
        ];


        @*var neighborhoods = [

            { lat: -34.590757, lng: @comercios. },
            { lat: -34.606903, lng: -58.425693 },
            { lat: -34.579161, lng: -58.452015 },
            { lat: -34.566954, lng: -58.434647 },
            { lat: -34.599523, lng: -58.382782 },
            { lat: -34.601839, lng: -58.592444 },
            { lat: -34.601977, lng: -58.572721 },
            { lat: -34.613118, lng: -58.362982 },
            { lat: -34.589040, lng: -58.447594 },
            { lat: -34.580127, lng: -58.424410 }
        ];*@

        var markers = [];
        var map;

        @ViewBag.Localizaciones

        function initMap() {


            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 13,
                center: { lat: -34.5979011, lng: -58.43593199999998 }
            });

            var infoWindow = new google.maps.InfoWindow({ map: map });
            var infowindow = new google.maps.InfoWindow({ content: contentString  });

            var contentString = '<div id="content">' +
                '<div id="siteNotice">' +
                '</div>' +
                '<h1 id="firstHeading" class="firstHeading">Uluru</h1>' +
                '<div id="bodyContent">' +
                '<p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large ' +
                'sandstone rock formation in the southern part of the ' +
                'Northern Territory, central Australia. It lies 335&#160;km (208&#160;mi) ' +
                'south west of the nearest large town, Alice Springs; 450&#160;km ' +
                '(280&#160;mi) by road. Kata Tjuta and Uluru are the two major ' +
                'features of the Uluru - Kata Tjuta National Park. Uluru is ' +
                'sacred to the Pitjantjatjara and Yankunytjatjara, the ' +
                'Aboriginal people of the area. It has many springs, waterholes, ' +
                'rock caves and ancient paintings. Uluru is listed as a World ' +
                'Heritage Site.</p>' +
                '<p>Attribution: Uluru, <a href="https://en.wikipedia.org/w/index.php?title=Uluru&oldid=297882194">' +
                'https://en.wikipedia.org/w/index.php?title=Uluru</a> ' +
                '(last visited June 22, 2009).</p>' +
                '</div>' +
                '</div>';




            // Try HTML5 geolocation.
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    var pos = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };


                    map.setCenter(pos);

                    var marker = new google.maps.Marker({
                        position: pos,

                        animation: google.maps.Animation.DROP,
                        map: map

                    });

                   @{
                       string ss = "";
                       int h = 0;
                       foreach (Comercio2 c in comercios)
                       {
                           h++;
                           ss += " var pos" + h + " = {";
                           ss += "   lat:" + c.lat.ToString().Replace(",", ".") + ",";
                           ss += "  lng: " + c.lng.ToString().Replace(",", ".") + "";
                           ss += "};";


                           ss += " map.setCenter(pos" + h + ");";

                           ss += "      var marker" + h + " = new google.maps.Marker({";
                           ss += "  position: pos" + h + ",";

                           ss += "  animation: google.maps.Animation.DROP,";
                           ss += "  map: map";

                           ss += "   });";

                       }
                   }
            @(ss)
                     
                       //        marker.addListener('click', toggleBounce);

                       marker.addListener('click', function () {
                           infowindow.open(map, marker);
                       });



                    function toggleBounce() {
                           if (marker.getAnimation() !== null) {
                               marker.setAnimation(null);
                           }
                           else {
                               marker.setAnimation(google.maps.Animation.BOUNCE);
                           }
                       }



                },

                    function () {
                        handleLocationError(true, infoWindow, map.getCenter());
                    });

            }
            else {
                // Browser doesn't support Geolocation
                handleLocationError(false, infoWindow, map.getCenter());
            }

        }

        function handleLocationError(browserHasGeolocation, infoWindow, pos) {
            infoWindow.setPosition(pos);
            infoWindow.setContent(browserHasGeolocation ?
                'Error: The Geolocation service failed.' :
                'Error: Your browser doesn\'t support geolocation.');
        }

        function markerJump() {

            marker.setAnimation(google.maps.Animation.BOUNCE);

        }



        function drop() {
            clearMarkers();

            for (var i = 0; i < neighborhoods.length; i++) {
                addMarkerWithTimeout(neighborhoods[i], i * 200);
            }
            var marker2 = new google.maps.Marker({
                position: { lat: -34.580127, lng: -58.424410 },

                animation: google.maps.Animation.DROP,
                map: map

            });

            marker2.addListener('click', toggleBounce2);
            function toggleBounce2() {
                if (marker2.getAnimation() !== null) {
                    marker2.setAnimation(null);
                }
                else {
                    marker2.setAnimation(google.maps.Animation.BOUNCE);
                }
            }
        }



        function addMarkerWithTimeout(position, timeout) {
            window.setTimeout(function () {
                markers.push(new google.maps.Marker({
                    position: position,
                    map: map,
                    animation: google.maps.Animation.DROP
                }));
            }, timeout);
        }

        function clearMarkers() {
            for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(null);
            }
            markers = [];
        }





    </script>

    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDpRBZnrnMtwFyxGD9Ve9AUvMUQdcDg_Rw&callback=initMap">
    </script>

    <div id="map"></div>





    <input type="checkbox" class="checkbox-lateral" id="check">
    <label class="menulateral" for="check">Filtros</label>

    <div class="left-panel-lateral">
        <ul id="ul">

            <a id="a" href=""><li id="li">COMIDA</li></a>
            <form>
                <input type="radio" name="gender" value="male" checked> Desayuno<br>
                <input type="radio" name="gender" value="female"> Almuerzo<br>
                <input type="radio" name="gender" value="other"> Merienda<br>
                <input type="radio" name="gender" value="female"> Cena
            </form>

            <a id="a" href=""><li id="li">COMERCIO</li></a>
            <form>
                <input type="radio" name="gender" value="male" checked> Todos<br>
                <input type="radio" name="gender" value="female"> Vegano <br>
                <input type="radio" name="gender" value="other"> Celíaco
            </form>

            <a id="a" href=""><li id="li">PRECIO</li></a>
            <form>
                <input type="radio" name="gender" value="male" checked> -$200<br>
                <input type="radio" name="gender" value="female"> hasta $600<br>
                <input type="radio" name="gender" value="other"> +600
            </form>

            <br>
            <div id="floating-panel">
                <label id="boton" onclick="drop()">Aplicar</label>
            </div>
            
            <br> <br> <br>
            
            <div id="floating-panel">
                <label id="boton" onclick="clearMarkers()">Limpiar</label>
            </div>

         


        </ul>
    </div>




    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

            </div>

            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li>@Html.ActionLink("Inicio", "Index", "Home")</li>
                    <li>@Html.ActionLink("Acerca de", "About", "Home")</li>
                    <li>@Html.ActionLink("Contacto", "Contact", "Home")</li>
                </ul>
                @Html.Partial("_LoginPartial")

            </div>
        </div>
    </div>


















    <div class="container body-content">
        @RenderBody()
    </div>


</body>
</html>
